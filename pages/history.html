<!DOCTYPE html>
<html lang="ko">
    
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ë””ìì´ë„ˆ íˆìŠ¤í† ë¦¬ - GOHAIR SNS ë§ˆì¼€íŒ… ê´€ë¦¬ ì‹œìŠ¤í…œ</title>
    
    <!-- CSS Files -->
    <link rel="stylesheet" href="../css/style.css">
    <link rel="stylesheet" href="../css/responsive.css">
    
    <!-- Firebase CDN -->
    <script src="https://www.gstatic.com/firebasejs/11.9.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/11.9.0/firebase-firestore-compat.js"></script>
    <style>
.period-buttons .period-btn {
    padding: 0.5rem 0.75rem;
    background: white;
    border: 1px solid #d1d5db;
    border-radius: 0.375rem;
    cursor: pointer;
    font-size: 0.875rem;
    font-weight: 500;
    transition: all 0.2s;
}

.period-buttons .period-btn:hover {
    background: #f3f4f6;
    border-color: #9ca3af;
}

.period-buttons .period-btn.active {
    background: #3b82f6;
    color: white;
    border-color: #3b82f6;
}

.hidden {
    display: none !important;
}
</style>
</head>
<body>
    <!-- Header -->
    <div class="header">
        <div class="header-content">
            <div class="header-top">
                <h1>GOHAIR SNS ë§ˆì¼€íŒ… ê´€ë¦¬ ì‹œìŠ¤í…œ</h1>
                <div class="header-actions">
                    <span id="currentUser"></span>
                    <button class="btn" onclick="goToMainSystem()">ğŸ  ë©”ì¸ìœ¼ë¡œ</button>
                </div>
            </div>
            
            <nav class="nav">
                <button class="nav-btn" onclick="goToMainSystem()">ğŸ  ëŒ€ì‹œë³´ë“œ</button>
                <button class="nav-btn" onclick="goToPage('designers')">ğŸ‘¥ ë””ìì´ë„ˆ ê´€ë¦¬</button>
                <button class="nav-btn" onclick="goToPage('branches')">ğŸ¢ ì§€ì  ê´€ë¦¬</button>
                <button class="nav-btn active">ğŸ“ˆ ë””ìì´ë„ˆ íˆìŠ¤í† ë¦¬</button>
                <button class="nav-btn" onclick="goToPage('checklist')">ğŸ“‹ ì²´í¬ë¦¬ìŠ¤íŠ¸ ì…ë ¥</button>
                <button class="nav-btn" onclick="goToPage('statistics')">ğŸ“Š í†µê³„ ë¶„ì„</button>
                <button class="nav-btn" onclick="goToPage('comparison')">âš–ï¸ ì§€ì  ë¹„êµ</button>
            </nav>
        </div>
    </div>

    <div class="container">
        <div id="historyPage">
            <div class="mb-6">
                <h2 class="text-2xl font-bold mb-4">ğŸ“ˆ ë””ìì´ë„ˆ íˆìŠ¤í† ë¦¬</h2>
                
<!-- í•„í„° ì»¨íŠ¸ë¡¤ -->
<div class="filter-controls">
    <div class="grid grid-cols-2 gap-6">
        <!-- ì²« ë²ˆì§¸ í–‰: ë””ìì´ë„ˆì™€ ì§€ì  ì„ íƒ -->
        <div>
            <label class="font-medium">ğŸ‘¤ ë””ìì´ë„ˆ ì„ íƒ</label>
            <select id="historyDesigner">
                <option value="">ë””ìì´ë„ˆë¥¼ ì„ íƒí•˜ì„¸ìš”</option>
            </select>
        </div>
        <div>
            <label class="font-medium">ğŸ¢ ì§€ì  í•„í„°</label>
            <select id="historyBranch">
                <option value="">ì „ì²´ ì§€ì </option>
            </select>
        </div>
        
        <!-- ë‘ ë²ˆì§¸ í–‰: ê¸°ê°„ ì„ íƒê³¼ ë‚ ì§œ ë²”ìœ„ -->
        <div>
            <label class="font-medium">ğŸ“… ê¸°ê°„ ì„ íƒ</label>
            <div class="period-buttons" style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 0.5rem; margin-bottom: 0.5rem;">
                <button type="button" class="period-btn" data-period="day">ì˜¤ëŠ˜</button>
                <button type="button" class="period-btn" data-period="week">ì´ë²ˆ ì£¼</button>
                <button type="button" class="period-btn active" data-period="month">ì´ë²ˆ ë‹¬</button>
                <button type="button" class="period-btn" data-period="quarter">ì´ë²ˆ ë¶„ê¸°</button>
                <button type="button" class="period-btn" data-period="all">ì „ì²´</button>
                <button type="button" class="period-btn" data-period="custom">ì‚¬ìš©ì ì •ì˜</button>
            </div>
        </div>
        
        <div>
            <label class="font-medium">ğŸ“† ë‚ ì§œ ë²”ìœ„</label>
            <div id="dateRangeDisplay" style="background: #f3f4f6; padding: 0.75rem; border-radius: 0.375rem; margin-bottom: 0.5rem; font-weight: 500; color: #374151;">
                2024-06-01 ~ 2024-06-30 (ì´ë²ˆ ë‹¬)
            </div>
            
            <!-- ì‚¬ìš©ì ì •ì˜ ë‚ ì§œ ì…ë ¥ (ê¸°ë³¸ì ìœ¼ë¡œ ìˆ¨ê¹€) -->
            <div id="customDateRange" class="hidden" style="display: grid; grid-template-columns: 1fr 1fr; gap: 0.5rem;">
                <div>
                    <label style="font-size: 0.875rem; color: #6b7280;">ì‹œì‘ì¼</label>
                    <input type="date" id="customStartDate" style="width: 100%; padding: 0.5rem; border: 1px solid #d1d5db; border-radius: 0.375rem;">
                </div>
                <div>
                    <label style="font-size: 0.875rem; color: #6b7280;">ì¢…ë£Œì¼</label>
                    <input type="date" id="customEndDate" style="width: 100%; padding: 0.5rem; border: 1px solid #d1d5db; border-radius: 0.375rem;">
                </div>
            </div>
            
            <button onclick="loadHistory()" class="btn" style="width: 100%; margin-top: 0.5rem;">
                ğŸ”„ íˆìŠ¤í† ë¦¬ ì¡°íšŒ
            </button>
        </div>
    </div>
</div>
            </div>

            <div id="historyContent" class="card">
                <div class="text-center" style="padding: 3rem;">
                    <div style="font-size: 3rem; margin-bottom: 1rem;">â„¹ï¸</div>
                    <p style="color: #6b7280;">ë””ìì´ë„ˆë¥¼ ì„ íƒí•˜ë©´ íˆìŠ¤í† ë¦¬ê°€ í‘œì‹œë©ë‹ˆë‹¤.</p>
                </div>
            </div>
        </div>
    </div>

    <!-- JavaScript Files -->
    <script src="../js/config/firebase.js"></script>
    <script src="../js/utils/data-manager.js"></script>
    <!-- <script src="../js/utils/auth.js"></script> --> <!-- ì„ì‹œë¡œ ì£¼ì„ ì²˜ë¦¬ -->
    <script src="../js/utils/ui-utils.js"></script>
    <script src="../js/pages/history.js"></script>


    <!-- í˜ì´ì§€ ë„¤ë¹„ê²Œì´ì…˜ í•¨ìˆ˜ -->

    <script>
    // íˆìŠ¤í† ë¦¬ ë¡œë“œ í•¨ìˆ˜
    function loadHistory() {
        const designerId = document.getElementById('historyDesigner').value;
        const period = document.getElementById('historyPeriod').value;
        
        if (!designerId) {
            alert('ë””ìì´ë„ˆë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”.');
            return;
        }
        
        // ì„ì‹œ íˆìŠ¤í† ë¦¬ í‘œì‹œ
        document.getElementById('historyContent').innerHTML = `
            <h3>ğŸ“Š ${document.getElementById('historyDesigner').selectedOptions[0].text} í™œë™ íˆìŠ¤í† ë¦¬</h3>
            <p style="color: #6b7280; margin-top: 1rem;">
                ğŸš§ íˆìŠ¤í† ë¦¬ ê¸°ëŠ¥ì€ ê°œë°œ ì¤‘ì…ë‹ˆë‹¤. ê³§ ì—…ë°ì´íŠ¸ ì˜ˆì •ì…ë‹ˆë‹¤.
            </p>
        `;
    }

    function goToMainSystem() {
        window.location.href = '../index.html';
    }
    
    function goToPage(pageId) {
        const pages = {
            'designers': 'designers.html',
            'branches': 'branches.html',
            'history': 'history.html',
            'checklist': 'checklist.html', 
            'statistics': 'statistics.html',
            'comparison': 'comparison.html'
        };
        
        if (pages[pageId]) {
            window.location.href = pages[pageId];
        }
    }

    // í˜ì´ì§€ ë¡œë“œ ì‹œ ì´ˆê¸°í™”
    document.addEventListener('DOMContentLoaded', function() {
        // ë””ìì´ë„ˆ ëª©ë¡ ë¡œë“œ
        const designerSelect = document.getElementById('historyDesigner');
        if (designerSelect) {
            designerSelect.innerHTML = `
                <option value="">ë””ìì´ë„ˆë¥¼ ì„ íƒí•˜ì„¸ìš”</option>
                <option value="1">ê¹€ìˆ˜í˜„</option>
                <option value="2">ì´ì§€ë¯¼</option>
                <option value="3">ë°•ì¤€í˜¸</option>
                <option value="4">ìµœë¯¸ì˜</option>
                <option value="5">ì •íƒœìœ¤</option>
            `;
        }
    });
        document.addEventListener('DOMContentLoaded', function() {
    console.log('ğŸ“ˆ íˆìŠ¤í† ë¦¬ í˜ì´ì§€ ë¡œë“œ ì‹œì‘');
    
    // Firebase ì—°ê²° ìƒíƒœ í™•ì¸
    if (typeof firebase !== 'undefined' && firebase.apps.length > 0) {
        console.log('ğŸ”¥ íŒŒì´ì–´ë² ì´ìŠ¤ ì—°ê²°ë¨');
        
        // ì—°ê²° ìƒíƒœë¥¼ í™”ë©´ì— í‘œì‹œ
        const currentUser = document.getElementById('currentUser');
        if (currentUser && !currentUser.textContent.trim()) {
            currentUser.textContent = 'íŒŒì´ì–´ë² ì´ìŠ¤ ì—°ê²°ë¨';
            currentUser.style.color = '#10b981'; // ì´ˆë¡ìƒ‰
        }
        
        // Firestore ì—°ê²° í…ŒìŠ¤íŠ¸
        if (firebase.firestore) {
            const db = firebase.firestore();
            console.log('ğŸ’¾ Firestore ì—°ê²° í™•ì¸ë¨');
            
            // ê°„ë‹¨í•œ ì—°ê²° í…ŒìŠ¤íŠ¸
            db.collection('checklists').limit(1).get()
                .then((snapshot) => {
                    if (snapshot.empty) {
                        console.log('ğŸ“‚ checklists ì»¬ë ‰ì…˜ì´ ë¹„ì–´ìˆìŒ - í…ŒìŠ¤íŠ¸ ë°ì´í„° ì¶”ê°€ ì œì•ˆ');
                        console.log('ğŸ’¡ ë¸Œë¼ìš°ì € ì½˜ì†”ì—ì„œ ë‹¤ìŒ ëª…ë ¹ì„ ì‹¤í–‰í•˜ì„¸ìš”:');
                        console.log(`
// í…ŒìŠ¤íŠ¸ ì²´í¬ë¦¬ìŠ¤íŠ¸ ë°ì´í„° ì¶”ê°€
const db = firebase.firestore();
db.collection('checklists').add({
    designerId: 'designer_1',
    designer: 'ê¹€ìˆ˜í˜„',
    branch: 'ì†¡ë„ì„¼íŠ¸ëŸ´ì ',
    date: '2024-06-10',
    naverReviews: 3,
    naverPosts: 2,
    naverExperience: 1,
    instaReels: 4,
    instaPhotos: 5,
    notes: 'ì˜¤ëŠ˜ì€ ê³ ê° ë°˜ì‘ì´ ì¢‹ì•˜ìŒ',
    createdAt: new Date().toISOString()
}).then(() => {
    console.log('âœ… í…ŒìŠ¤íŠ¸ ì²´í¬ë¦¬ìŠ¤íŠ¸ ì¶”ê°€ë¨');
    location.reload();
});
                        `);
                    } else {
                        console.log(`âœ… checklists ì»¬ë ‰ì…˜ì— ${snapshot.size}ê°œ ë¬¸ì„œ ì¡´ì¬`);
                    }
                })
                .catch((error) => {
                    console.log('âš ï¸ Firestore ì½ê¸° í…ŒìŠ¤íŠ¸ ì‹¤íŒ¨:', error.message);
                });
        }
    } else {
        console.log('âŒ íŒŒì´ì–´ë² ì´ìŠ¤ ì—°ê²° ì‹¤íŒ¨');
        
        const currentUser = document.getElementById('currentUser');
        if (currentUser && !currentUser.textContent.trim()) {
            currentUser.textContent = 'íŒŒì´ì–´ë² ì´ìŠ¤ ì—°ê²° ì‹¤íŒ¨';
            currentUser.style.color = '#ef4444'; // ë¹¨ê°„ìƒ‰
        }
    }
    
    // 1ì´ˆ í›„ HistoryManager í™•ì¸
    setTimeout(() => {
        if (window.historyManager) {
            console.log('âœ… HistoryManager ì´ˆê¸°í™” ì™„ë£Œ');
        } else {
            console.log('âš ï¸ HistoryManager ì´ˆê¸°í™” ëŒ€ê¸° ì¤‘...');
        }
    }, 1000);
});

// ì—ëŸ¬ ë°œìƒ ì‹œ ë¡œê·¸
window.addEventListener('error', function(e) {
    console.error('âŒ JavaScript ì—ëŸ¬:', e.message);
    console.error('ğŸ“ íŒŒì¼:', e.filename);
    console.error('ğŸ“ ë¼ì¸:', e.lineno);
});
</script>
</body>
</html>
