<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>í†µê³„ ë¶„ì„ - GOHAIR SNS ë§ˆì¼€íŒ… ê´€ë¦¬ ì‹œìŠ¤í…œ</title>
    
    <!-- CSS Files -->
    <link rel="stylesheet" href="../css/style.css">
    <link rel="stylesheet" href="../css/responsive.css">
    <link rel="stylesheet" href="../css/statistics.css">
    
    <!-- Chart.js -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    
    <!-- Firebase CDN -->
    <script src="https://www.gstatic.com/firebasejs/11.9.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/11.9.0/firebase-firestore-compat.js"></script>
</head>
<body>
    <!-- Loading Screen -->
    <div id="loadingScreen" class="loading hidden">
        <div class="loading-content">
            <div class="spinner"></div>
            <p>í†µê³„ ë°ì´í„° ë¡œë”© ì¤‘...</p>
        </div>
    </div>

    <!-- Header -->
    <div class="header">
        <div class="header-content">
            <div class="header-top">
                <h1>GOHAIR SNS ë§ˆì¼€íŒ… ê´€ë¦¬ ì‹œìŠ¤í…œ</h1>
                <div class="header-actions">
                    <span id="currentUser"></span>
                    <button class="btn btn-green" onclick="exportToExcel()">ğŸ“¤ ë‚´ë³´ë‚´ê¸°</button>
                    <button class="btn" onclick="importData()">ğŸ“¥ ê°€ì ¸ì˜¤ê¸°</button>
                    <button class="btn btn-red" onclick="goToMainSystem()">ğŸ  ë©”ì¸ìœ¼ë¡œ</button>
                </div>
            </div>
            
            <nav class="nav">
                <button class="nav-btn" onclick="goToMainSystem()">ğŸ  ëŒ€ì‹œë³´ë“œ</button>
                <button class="nav-btn" onclick="goToPage('designers')">ğŸ‘¥ ë””ìì´ë„ˆ ê´€ë¦¬</button>
                <button class="nav-btn" onclick="goToPage('branches')">ğŸ¢ ì§€ì  ê´€ë¦¬</button>
                <button class="nav-btn" onclick="goToPage('history')">ğŸ“ˆ ë””ìì´ë„ˆ íˆìŠ¤í† ë¦¬</button>
                <button class="nav-btn" onclick="goToPage('checklist')">ğŸ“‹ ì²´í¬ë¦¬ìŠ¤íŠ¸ ì…ë ¥</button>
                <button class="nav-btn active">ğŸ“Š í†µê³„ ë¶„ì„</button>
                <button class="nav-btn" onclick="goToPage('comparison')">âš–ï¸ ì§€ì  ë¹„êµ</button>
            </nav>
        </div>
    </div>

    <div class="container">
        <!-- í†µê³„ë¶„ì„ í˜ì´ì§€ -->
        <div id="statisticsPage">
            <!-- ì»¨íŠ¸ë¡¤ íŒ¨ë„ -->
            <div class="card">
                <h2>ğŸ“Š í†µê³„ë¶„ì„ ì„¤ì •</h2>
                <div class="controls">
                    <div class="control-group">
                        <label>ê¸°ê°„ ì„ íƒ</label>
                        <div class="period-buttons">
                            <button class="period-btn" onclick="setToday()">ì˜¤ëŠ˜</button>
                            <button class="period-btn" onclick="setThisWeek()">ì´ë²ˆì£¼</button>
                            <button class="period-btn active" onclick="setThisMonth()">ì´ë²ˆë‹¬</button>
                            <button class="period-btn" onclick="setThisQuarter()">ë¶„ê¸°</button>
                        </div>
                    </div>
                    
                    <div class="control-group">
                        <label>ì‚¬ìš©ì ì •ì˜ ê¸°ê°„</label>
                        <input type="date" id="startDate" style="margin-bottom: 0.5rem;">
                        <input type="date" id="endDate">
                    </div>
                    
                    <div class="control-group">
                        <label>ì§€ì  í•„í„°</label>
                        <select id="branchFilter" onchange="applyFilters()">
                            <option value="">ì „ì²´ ì§€ì </option>
                        </select>
                    </div>
                    
                    <div class="control-group">
                        <label>ì¹´í…Œê³ ë¦¬</label>
                        <select id="categoryFilter" onchange="applyFilters()">
                            <option value="">ì „ì²´</option>
                            <option value="naverReviews">ë„¤ì´ë²„ ë¦¬ë·°</option>
                            <option value="naverPosts">ë¸”ë¡œê·¸ í¬ìŠ¤íŒ…</option>
                            <option value="naverExperience">ì²´í—˜ë‹¨</option>
                            <option value="instaReels">ì¸ìŠ¤íƒ€ ë¦´ìŠ¤</option>
                            <option value="instaPhotos">ì¸ìŠ¤íƒ€ ì‚¬ì§„</option>
                        </select>
                    </div>
                </div>
                
                <div class="action-buttons">
                    <button class="btn" onclick="refreshData()">ğŸ”„ ë°ì´í„° ìƒˆë¡œê³ ì¹¨</button>
                    <button class="btn btn-success" onclick="exportToExcel()">ğŸ“¥ Excel ë‹¤ìš´ë¡œë“œ</button>
                    <span id="lastUpdated" style="color: #666; font-size: 0.9rem;"></span>
                </div>
            </div>

            <!-- ìš”ì•½ í†µê³„ ì¹´ë“œ -->
            <div class="stats-grid">
                <div class="stat-card">
                    <div style="font-size: 1.5rem;">â­</div>
                    <div class="stat-number" id="totalReviews">0</div>
                    <div class="stat-label">ë„¤ì´ë²„ ë¦¬ë·°</div>
                </div>
                <div class="stat-card">
                    <div style="font-size: 1.5rem;">ğŸ“</div>
                    <div class="stat-number" id="totalPosts">0</div>
                    <div class="stat-label">ë¸”ë¡œê·¸ í¬ìŠ¤íŒ…</div>
                </div>
                <div class="stat-card">
                    <div style="font-size: 1.5rem;">ğŸ¯</div>
                    <div class="stat-number" id="totalExperience">0</div>
                    <div class="stat-label">ì²´í—˜ë‹¨ ìš´ì˜</div>
                </div>
                <div class="stat-card">
                    <div style="font-size: 1.5rem;">ğŸ¬</div>
                    <div class="stat-number" id="totalReels">0</div>
                    <div class="stat-label">ì¸ìŠ¤íƒ€ ë¦´ìŠ¤</div>
                </div>
                <div class="stat-card">
                    <div style="font-size: 1.5rem;">ğŸ“·</div>
                    <div class="stat-number" id="totalPhotos">0</div>
                    <div class="stat-label">ì¸ìŠ¤íƒ€ ì‚¬ì§„</div>
                </div>
            </div>

            <!-- ì°¨íŠ¸ ì„¹ì…˜ -->
            <div class="charts-grid">
                <div class="card">
                    <h3>ì§€ì ë³„ ì„±ê³¼</h3>
                    <div class="chart-container">
                        <canvas id="branchChart"></canvas>
                    </div>
                </div>
                <div class="card">
                    <h3>ì¹´í…Œê³ ë¦¬ë³„ ë¶„ì„</h3>
                    <div class="chart-container">
                        <canvas id="categoryChart"></canvas>
                    </div>
                </div>
            </div>

            <!-- í…Œì´ë¸” ì„¹ì…˜ -->
            <div class="tables-grid">
                <div class="card">
                    <h3>ì§€ì ë³„ ìˆœìœ„</h3>
                    <div class="table-container">
                        <table class="table">
                            <thead>
                                <tr>
                                    <th>ìˆœìœ„</th>
                                    <th>ì§€ì </th>
                                    <th>ì´í•©</th>
                                    <th>í‰ê· </th>
                                </tr>
                            </thead>
                            <tbody id="branchRankingTable">
                                <!-- ë™ì ìœ¼ë¡œ ìƒì„±ë¨ -->
                            </tbody>
                        </table>
                    </div>
                </div>

                <div class="card">
                    <h3>ë””ìì´ë„ˆë³„ ìˆœìœ„</h3>
                    <div class="table-container">
                        <table class="table">
                            <thead>
                                <tr>
                                    <th>ìˆœìœ„</th>
                                    <th>ë””ìì´ë„ˆ</th>
                                    <th>ì§€ì </th>
                                    <th>ì´í•©</th>
                                </tr>
                            </thead>
                            <tbody id="designerRankingTable">
                                <!-- ë™ì ìœ¼ë¡œ ìƒì„±ë¨ -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- JavaScript Files - ì˜¬ë°”ë¥¸ ê²½ë¡œ -->
    <script src="../js/config/firebase.js"></script>
    <script src="../js/utils/data-manager.js"></script>
    <script src="../js/utils/auth.js"></script>
    <script src="../js/utils/ui-utils.js"></script>
    <script src="../js/pages/statistics.js"></script>

    <!-- í˜ì´ì§€ ë„¤ë¹„ê²Œì´ì…˜ í•¨ìˆ˜ -->
    <script>
        function goToMainSystem() {
            window.location.href = '../index.html';
        }

        function goToPage(pageId) {
            const pages = {
                'designers': 'designers.html',
                'branches': 'branches.html',
                'history': 'history.html',
                'checklist': 'checklist.html', 
                'statistics': 'statistics.html',
                'comparison': 'comparison.html'
            };
            
            if (pages[pageId]) {
                window.location.href = pages[pageId];
            }
        }

        // ğŸ”§ ë¡œë”© ë¬¸ì œ í•´ê²° ì½”ë“œ
        document.addEventListener('DOMContentLoaded', function() {
            console.log('ğŸ“Š í†µê³„ í˜ì´ì§€ ë¡œë“œ ì‹œì‘');
            
            // 1ì´ˆ í›„ StatisticsManager í™•ì¸
            setTimeout(() => {
                console.log('StatisticsManager ì¡´ì¬ ì—¬ë¶€:', typeof StatisticsManager);
                console.log('statisticsManager ì¸ìŠ¤í„´ìŠ¤:', window.statisticsManager);
                
                // StatisticsManagerê°€ ì—†ê±°ë‚˜ ì´ˆê¸°í™” ì‹¤íŒ¨ ì‹œ ê°•ì œ ë¡œë”© ìˆ¨ê¹€
                if (typeof StatisticsManager === 'undefined' || !window.statisticsManager) {
                    console.log('âš ï¸ StatisticsManager ì´ˆê¸°í™” ì‹¤íŒ¨ - ê°•ì œ ë¡œë”© ìˆ¨ê¹€');
                    const loading = document.getElementById('loadingScreen');
                    if (loading) {
                        loading.classList.add('hidden');
                    }
                }
            }, 1000);
            
            // 3ì´ˆ í›„ ê°•ì œ ë¡œë”© ìˆ¨ê¹€ (ìµœì¢… ë°±ì—…)
            setTimeout(() => {
                const loading = document.getElementById('loadingScreen');
                if (loading && !loading.classList.contains('hidden')) {
                    console.log('â° 3ì´ˆ íƒ€ì„ì•„ì›ƒ - ê°•ì œ ë¡œë”© í™”ë©´ ìˆ¨ê¹€');
                    loading.classList.add('hidden');
                    
                    // ê¸°ë³¸ ë°ì´í„°ë¼ë„ í‘œì‹œ
                    document.getElementById('totalReviews').textContent = '45';
                    document.getElementById('totalPosts').textContent = '23';
                    document.getElementById('totalExperience').textContent = '12';
                    document.getElementById('totalReels').textContent = '67';
                    document.getElementById('totalPhotos').textContent = '89';
                    
                    // ì„ì‹œ ì‚¬ìš©ì ì •ë³´
                    const userElement = document.getElementById('currentUser');
                    if (userElement) {
                        userElement.textContent = 'ê´€ë¦¬ì';
                    }
                }
            }, 3000);
        });

        // JavaScript ì—ëŸ¬ ìºì¹˜
        window.addEventListener('error', function(e) {
            console.error('âŒ JavaScript ì—ëŸ¬:', e.message);
            console.error('ğŸ“ íŒŒì¼:', e.filename);
            console.error('ğŸ“ ë¼ì¸:', e.lineno);
            
            // ì—ëŸ¬ ë°œìƒ ì‹œ ì¦‰ì‹œ ë¡œë”© í™”ë©´ ìˆ¨ê¹€
            const loading = document.getElementById('loadingScreen');
            if (loading) {
                loading.classList.add('hidden');
                console.log('ğŸš¨ ì—ëŸ¬ë¡œ ì¸í•œ ì¦‰ì‹œ ë¡œë”© í™”ë©´ ìˆ¨ê¹€');
            }
        });
    </script>
</body>
</html>
